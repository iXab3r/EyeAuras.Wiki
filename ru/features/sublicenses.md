---
title: Лицензии на паки
description: 
published: true
date: 2024-08-09T21:43:18.918Z
tags: 
editor: markdown
dateCreated: 2024-08-08T11:29:40.683Z
---

> Альфа-тест! Внимание! Attention! Achtung! Atención Attention 注意 انتباه Atenção Attenzione
{.is-warning}

# Что вообще такое лицензии на паки ака саб-лицензии ?
**У вас**, т.е. пользователей программы, появляется возможность выпускать **свои собственные** лицензионные ключи, которые открывают доступ человеку к **вашему** конкретному паку с аурами. Вы сами их выпускаете(soon), сами распространяете и назначаете цену, сами общаетесь с пользователями. 
По факту они дают возможность **вам** (автору пака) контролировать кто и как пользуется результатами вашей работы. Глаз будет контролировать этот процесс теми же механизмами, которыми он контролирует свои лицензии, ну и само собой части связанной с безопасностью в ближайшие 6 месяцев я уделю дополнительное внимание. 

## Авторизация через ключи
Для упрощения работы с новыми пользователями появилась возможность логиниться в программу без регистрации, для этого достаточно вбить ключ и все - глаз автоматически создаст нового пользователя и присвоит ему этот ключ. От "обычного" пользователя он ничем не отличается, кроме странного имени и ему доступны все те же возможности. Идея в том, что пользователи, которые приходят в программу, имея на руках ключ, не особо заинтересованы в самом глазе, им интересен именно продукт, который создан на его основе, так что нет смысла их пытаться заставлять регистрироваться  и т.п. Если им все понравится - они смогут пост-фактум сменить имя на нормальное (сейчас там user123123123123) и погрузиться глубже в инфраструктуру.

![Auth via key](https://s3.eyeauras.net/media/2024/08/EyeAuras_U9gCDJGiIGaWEQDV.png)


## По поводу активации и выпуска ключей
Пока что процесс максимально ручной - вы пишете [мне](https://wiki.eyeauras.net/en/contacts), мол, так и так, мне нужно 10-15-20 ключей на вот этот пак. Я нажимаю кнопки, выпускаю ключи и отдаю вам. 
Что дальше с ними пройзодет - исключительно **ваше** дело. 

В обозримом будущем, как система стабилизируется, на странице пака появится мини-админка, в которой вы будете видеть выпущенные ключи и сможет наклепать их сами, но это уже скорее всего **2025**. А пока социализируемся! :-D


# F.A.Q.
## Я автор пака, хочу!
Пишите [мне](https://wiki.eyeauras.net/en/contacts) - все сделаем и настроим. Перед этим настройте пожалуйста страницу вашего пака, чтобы было хотя бы видно о чем речь.
Вот примеры от `@linqse`:
- https://eyeauras.net/share/S20240628015518RjpkU2Sdkh5I
- https://eyeauras.net/share/S20240710235018df4VPCkM0Wan

p.s. Если распространяете что-то сильно приватное - тогда можно и без страницы само собой. 

## Какие виды ключей бывают и что можно настраивать
У ключа есть несколько характеристик
- **длительность**: просто время, на которое ключ открывает доступ к вашему паку. Минимум - 1 день. 
- **количество компьютеров**: сколько одновременно машин с запущенным паком могут работать
- **количество сессий**: сколько одновременно паков могут работать. К примеру, на **одном **компьютере запущено **три** глаза с вашим паком = **3** сессии. На **трех **компьютерах по **одному **паку = **3** сессии.

На этом этапе **сессии** и **компьютеры** мы ограничивать не будем, все выпускаемые ключи будут поддерживать сколько угодно сессий. Как только механизм отслеживания стабилизируется(давайте дадим ему пару месяцев) - у вас откроется доступ к ограничению на количество компьютеров. Ну и самым последним появится ограничение на количество сессий. 


## Как активировать ключи ?
После того, как человек получил заветную последовательность символов, он может
1) Привязать ее к своему аккаунту
![Activate key](https://s3.eyeauras.net/media/2024/08/EyeAuras_PbHuwp3yIoKuEIHy.png)
2) Авторизироваться напрямую с использованием ключа (ниже)
![Authorize](https://s3.eyeauras.net/media/2024/08/EyeAuras_U9gCDJGiIGaWEQDV.png)

Использовать ключ можно ИЛИ одним способом, ИЛИ другим. 

## Как из моего пака проверить доступ пользователя?
Ближайший **~месяц** сам глаз **никак** не будет контролировать доступ к аурам - все будет работать ровно так же, как работало все это время. 
Вы, как автор пака, можете добавить вот такой код - он берет текущую лицензию, проверяет саблицензии и наличие вашего пака в ней. 
```csharp
var hasSublicense = GetService<EyeAuras.Loader.Shared.Api.ILicenseAccessor>()
	.ShareSublicenses
	.Any(x => "<your-share-id, e.g. S20240710235018df4VPCkM0Wan>" == x.ShareId);
```
Так же работает и реактивный подход - в таком варианте как только лицензия обновится (по любой причине), вы сразу получите оповещение.
```csharp
GetService<EyeAuras.Loader.Shared.Api.ILicenseAccessor>()
        .WhenAnyValue(x => x.ShareSublicenses) // subscribe to license updates
        .Select(x => x.Any(y => "<your-share-id, e.g. S20240710235018df4VPCkM0Wan>" == y.ShareId)) 
        .Subscribe(hasAccess => Log.Info($"User has access: {hasAccess}"))
        .AddTo(Anchors);
```

Дальше на этот скрипт можно повесить [пермиссию](/permission-model) `Private` и тем самым указать, что у пользователя не должно быть доступа редактировать и просматривать этот код.

> Как обкатаем сам механизм выпуска/доставки/активации будет следующий этап, где глаз будет делать эту часть работы сам и необходимости в скрипте не будет.
{.is-info}

## Как лицензия самого глаза связана с саб-лицензиями
Технически, это две абсолютно не связанные вещи и можно выпускать ключи в трех вариантах
- лицензия на глаз, которая открывает доступ к большему числу аур и т.п.
- саб-лицензии, которые открывают доступ к определенному паку
- любая комбинация из лицензии на глаз + сколько угодно саб-лицензий

**Пока что**, для удобства распространения, выпускаемые саб-лицензии будут включать в себя **И** лицензию на сам глаз, **И** саб-лицензию, т.е. пользователю достаточно будет 1 ключа, чтобы полноценно начать пользоваться вашим паком.


## Финансовая сторона вопроса
Для пользователя цена ключа состоит из двух частей
- цена программы (~5$, назначаю я)
- цена пака (назначает **автор**)

На этом этапе авторов паков, которые заинтересованы в саб-лицензиях я знаю поименно, поэтому все решим через чатик - нам все равно нужно будет еще несколько месяцев пересекаться по поводу выпуска ключей. Вы берете саб-ключи, распространяете любыми удобными каналами. Если все хорошо - приходите еще. 
 
В следующий год я постараюсь все это дело автоматизировать насколько это возможно.
